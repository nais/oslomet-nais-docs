<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
     <link rel="canonical" href="https://nais.io/oslomet-nais-docs/basics/access/"> 
    
    
    <link rel="icon" type="image/x-icon" href="../../assets/logo.svg">
    

    
    <title>Access from laptop - NAIS</title>
    

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/v4-shims.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.min.css">
    <link href='//rsms.me/inter/inter.css' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../css/bootstrap.min.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/cinder.css" rel="stylesheet">

    
        
        <link rel="stylesheet" href="../../css/highlight.css">
        
    

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
        <![endif]-->

    

     
</head>

<body>

    <header class="navbar fixed-top navbar-expand-md navbar-dark bg-dark">
    <nav class="container-fluid" aria-label="toolbar">
        
        

            
            <a class="navbar-brand" href="../..">
                <img alt="logo" height="36" src="../../assets/logo.svg" class="align-items-center"/>
                 NAIS platform documentation 
            </a>
            

        

        
        
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle toolbar">
            <span class="navbar-toggler-icon"></span>
        </button>
        

        
        <div class="navbar-collapse collapse" id="navbarSupportedContent">
            <ul class="navbar-nav flex-grow-1 justify-content-end">
                
                    
                    <li class="nav-item d-grid m-1">
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal" type="button">
                            <span class="fas fa-search"></span> Search
                        </button>
                    </li> 
                    
                

                
                    

                    
                    
                    <li class="nav-item d-grid m-1">
                        <a href="../.." rel="prev" role="button" class="btn btn-secondary">
                            <span class="fas fa-arrow-left"></span> Previous page
                        </a>
                    </li>
                    

                    
                    
                    <li class="nav-item d-grid m-1">
                        <a href="../teams/" rel="next" role="button" class="btn btn-secondary">
                            Next page <span class="fas fa-arrow-right"></span>
                        </a>
                    </li>
                    

                    
                

                
                
                    
                        <li class="nav-item my-auto">
                            <a href="https://github.com/nais/oslomet-nais-docs/" class="btn nav-link">
                                
                                    <span class="fab fa-github"></span> NAIS on Github                                    
                                
                            </a>
                        </li>
                    
                
            </ul>
        </div>
    </nav>
</header>

    <div class="container-fluid">
        <div class="row">
            
            
                <aside class="col-md-6 col-lg-3 col-xl-2 order-lg-1" aria-label="primary">


<nav class="mb-5 sticky-top sidebar-sticky" aria-labelledby="nav-label">
    <span id="nav-label" class="fs-4">Navigation:</span>
    <ul class="list-unstyled py-2 mt-3 sidebar-sticky-overflow border-top border-bottom">
        

            

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 bg-grey rounded-top" href='



    

    ../..

' aria-current="location"><strong>NAIS</strong></a>
            <ul class="list-unstyled ps-2 border-start border-bottom py-1">
                
            
                    

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href="../..">Introduction to NAIS</a>
        
    </li>

                 
                
            
                    

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 bg-grey rounded-top" href='



    

    ./

' aria-current="location"><strong>Getting started</strong></a>
            <ul class="list-unstyled ps-2 border-start border-bottom py-1">
                
            
                    

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 bg-warning rounded" href="./" aria-current="page"><strong>Access from laptop</strong></a>
        
    </li>

                 
                
            
                    

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href="../teams/">Teams</a>
        
    </li>

                 
                
            
                    

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href="../application/">Your first NAIS application</a>
        
    </li>

                 
                
            </ul>
        
    </li>


                 
                
            
                    

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href='



    

    ../../clusters/gcp/

'> Clusters</a>
        
    </li>


                 
                
            
                    

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href='



    

    ../../nais-application/example/

'> NAIS Application</a>
        
    </li>


                 
                
            
                    

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href='



    

    ../../naisjob/

'> Naisjob</a>
        
    </li>


                 
                
            
                    

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href='



    

    ../../deployment/

'> Deploy</a>
        
    </li>


                 
                
            
                    

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href='



    

    

    



    

    ../../observability/alerts/



'> Observability</a>
        
    </li>


                 
                
            
                    

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href='



    

    ../../persistence/responsibilities/

'> Persistence</a>
        
    </li>


                 
                
            
                    

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href='



    

    

    



    

    ../../security/auth/



'> Security</a>
        
    </li>


                 
                
            
                    

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href='



    

    ../../addons/leader-election/

'> Addons</a>
        
    </li>


                 
                
            
                    

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href='



    

    ../../legacy/sunset/

'> Legacy</a>
        
    </li>


                 
                
            
                    

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href='



    

    ../../appendix/zero-trust/

'> Appendix</a>
        
    </li>


                 
                
            
                    

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href="../../support/">Support</a>
        
    </li>

                 
                
            </ul>
        
    </li>



        

            

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href='



    

    ../../device/

'> naisdevice</a>
        
    </li>



        

            

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href='



    

    ../../cli/

'> nais-cli</a>
        
    </li>



        

            

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href='



    

    ../../legal/roles-responsibilities/

'> Laws and regulations</a>
        
    </li>



        

            

    

    <li class="mx-1">
        
            <a class="link-dark link-hover-underline d-block p-1 rounded" href='



    

    ../../theme-dev/

'> Theme Dev</a>
        
    </li>



        
    </ul>
</nav>


</aside>
                <aside class="col-md-6 col-lg-3 col-xl-3 order-lg-3" aria-label="secondary"><nav class="mb-5 sticky-top sidebar-sticky " aria-labelledby="toc-label">
    <span id="toc-label" class="fs-4">On this page:</span>
    <ul class="list-unstyled py-2 mt-3 sidebar-sticky-overflow border-top border-bottom">
        
        <li class="m-1">
            <strong><a class="link-dark link-hover-underline d-block" href="#access-from-laptop">Access from laptop</a></strong>
            
            <ul class="ps-3">
                
                <li class="m-1">
                    <a class="link-dark link-hover-underline d-block" href="#set-up-a-team">Set up a team</a>
                    
                </li>
                
                <li class="m-1">
                    <a class="link-dark link-hover-underline d-block" href="#install-naisdevice">Install naisdevice</a>
                    
                </li>
                
                <li class="m-1">
                    <a class="link-dark link-hover-underline d-block" href="#install-kubectl">Install kubectl</a>
                    
                </li>
                
                <li class="m-1">
                    <a class="link-dark link-hover-underline d-block" href="#setup-your-kubeconfig">Setup your kubeconfig</a>
                    
                </li>
                
                <li class="m-1">
                    <a class="link-dark link-hover-underline d-block" href="#authenticate-kubectl">Authenticate kubectl</a>
                    
                    <ul class="ps-3">
                        
                        <li class="m-1">
                            <a class="link-dark link-hover-underline d-block" href="#google-cloud-platform-gcp">Google Cloud Platform (GCP)</a>
                        </li>
                        
                        <li class="m-1">
                            <a class="link-dark link-hover-underline d-block" href="#on-premise">On-premise</a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                <li class="m-1">
                    <a class="link-dark link-hover-underline d-block" href="#recommended-tools">Recommended tools</a>
                    
                </li>
                
            </ul>
            
        </li>    
        
    </ul>
</nav></aside>
                <main class="col-md-12 col-lg-6 col-xl-7 order-lg-2" aria-label="main content">
<div class="mb-2">
    <a href="https://github.com/nais/oslomet-nais-docs/edit/main/docs/basics/access.md">
        <span class="fas fa-edit"></span> Edit this page
    </a>
</div>


<h1 id="access-from-laptop">Access from laptop<a class="headerlink" href="#access-from-laptop" title="Permanent link">§</a></h1>
<p>This guide will take you through the required tools and permissions that need to be in place for you to be able to operate your own NAIS application directly from your laptop.</p>
<h2 id="set-up-a-team">Set up a team<a class="headerlink" href="#set-up-a-team" title="Permanent link">§</a></h2>
<p>The primary unit of access is a <em>team</em>, whose origin is a group in Azure AD.
Each team is given its own namespace with the same name as the team.
The team will have unrestricted access to all Kubernetes assets in that namespace.</p>
<p>See <a href="../teams/#creating-a-new-team">creating a new team</a> to get started with teams.
After creating a new team, you should have access to all clusters.</p>
<div class="admonition info">
<p class="admonition-title">You're probably part of an existing team</p>
<p>If this is your first time here, chances are that you're already part of a team in the context of NAIS.
There is currently no simple way to verify this, though you can look through <a href="https://account.activedirectory.windowsazure.com/r#/groups">the AAD-groups that you are part of</a> and see if there's any overlap with <a href="https://github.com/navikt/teams/blob/main/teams.md">navikt/teams</a>.</p>
</div>
<h2 id="install-naisdevice">Install <a href="../../device/">naisdevice</a><a class="headerlink" href="#install-naisdevice" title="Permanent link">§</a></h2>
<p>naisdevice ensures that your laptop meets NAVs requirements before allowing access to internal resources such as our NAIS clusters. 
Install by following the <a href="../../device/install/">naisdevice installation guide</a>.</p>
<h2 id="install-kubectl">Install <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl"><code>kubectl</code></a><a class="headerlink" href="#install-kubectl" title="Permanent link">§</a></h2>
<p><code>kubectl</code> is a command-line tool used to manage your Kubernetes resources.</p>
<p>Check out the <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl">official documentation</a> for instructions on how to install the binaries.</p>
<p>Remember that <code>kubectl</code> is supported within one minor version (older or newer) of <code>kube-apiserver</code>.
This is called <a href="https://kubernetes.io/releases/version-skew-policy/#kubectl"><code>version skew</code></a>.
You can see our on-prem version over at <a href="https://github.com/nais/naisible/blob/master/group_vars/all#L12">naisible/group_vars</a>.</p>
<p>Using <code>brew</code> to manage <code>kubectl</code> will make it troublesome to be within the version skew, as it's hard to downgrade <code>kubectl</code> to older versions.
Therefor we recommend installing <code>kubectl</code> manually, or through tools like <a href="https://asdf-vm.com/">asdf</a>.</p>
<h2 id="setup-your-kubeconfig">Setup your <a href="https://kubernetes.io/docs/concepts/configuration/organize-cluster-access-kubeconfig/"><code>kubeconfig</code></a><a class="headerlink" href="#setup-your-kubeconfig" title="Permanent link">§</a></h2>
<p>The <code>kubectl</code> tool uses a <code>kubeconfig</code> file to get the information it needs in order to connect to a cluster.
We provide a <a href="https://github.com/navikt/kubeconfigs">pre-made kubeconfig</a> file with NAV's clusters.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>If you use <code>utviklerimage</code> or connect to NAV through BigIP VPN you need to use the kubeconfig under the Git tag <code>utviklerimage</code>. Go to the directory where you cloned kubeconfig and run</p>
<div class="codehilite"><pre><span></span><code>git fetch --all --tags --prune
git checkout tags/utviklerimage
</code></pre></div>
</div>
<p><code>kubectl</code> will by default look for a file named <code>config</code> in the <code>$HOME/.kube/</code> folder. This can be overriden by having the absolute path of the file in the environment variable <code>KUBECONFIG</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="nb">export</span> <span class="nv">KUBECONFIG</span><span class="o">=</span><span class="s2">&quot;&lt;path to your navikt/kubeconfigs repo&gt;/config&quot;</span>
</code></pre></div>
<p>The above example can also be added to something like <code>~/.bash_profile</code>, or the equivalent in your preferred shell.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you use cygwin, you need the <code>KUBECONFIG</code> to be in Windows style paths rather than unix style paths (e.g. <code>C:\dev\kubeconfigs\config</code> instead of <code>/cygdrive/c/dev/kubeconfigs/config</code>)</p>
</div>
<h2 id="authenticate-kubectl">Authenticate <code>kubectl</code><a class="headerlink" href="#authenticate-kubectl" title="Permanent link">§</a></h2>
<h3 id="google-cloud-platform-gcp">Google Cloud Platform (GCP)<a class="headerlink" href="#google-cloud-platform-gcp" title="Permanent link">§</a></h3>
<p>Before following these steps, make sure your team is enabled for Google Cloud Platform, check out <a href="../teams/">team access</a> for more information.</p>
<p>You will also need to perform a self-service step to synchronize your user from Azure AD to Google Cloud Platform. This can be done by following these steps:</p>
<ol>
<li>Login to <a href="https://myapps.microsoft.com">https://myapps.microsoft.com</a> using your NAV user</li>
<li>Click on "Add app" at the top of the page</li>
<li>Locate "Google Cloud Platform", and click on the icon</li>
</ol>
<p>After you have done this your user will be synced to Google Cloud Platform. The sync is not instantaneous, but usually does not take more than a few minutes.</p>
<p>First you need to install <code>gcloud</code> following the <a href="https://cloud.google.com/sdk/docs/install">instructions</a> for your platform.</p>
<p>Once installed, you need to authenticate with Google using your NAV e-mail.</p>
<div class="codehilite"><pre><span></span><code>$ gcloud auth login
</code></pre></div>
<p>Make sure you are connected to the right cluster, and verify that it works.</p>
<div class="codehilite"><pre><span></span><code>$ kubectl config use-context prod-gcp
Switched to context <span class="s2">&quot;prod-gcp&quot;</span>.
$ kubectl cluster-info
gcp-terraform $ k cluster-info
Kubernetes master is running at https://127.0.0.1:14131
...
</code></pre></div>
<h3 id="on-premise">On-premise<a class="headerlink" href="#on-premise" title="Permanent link">§</a></h3>
<p>When connecting to on-premise clusters, you need to authenticate with Azure AD.</p>
<div class="codehilite"><pre><span></span><code>$ kubectl config use-context prod-fss
Switched to context <span class="s2">&quot;prod-fss&quot;</span>.

$ kubectl get pods
To sign <span class="k">in</span>, use a web browser to open the page https://microsoft.com/devicelogin and enter the code CR69DPQQZ to authenticate.
</code></pre></div>
<p>When prompted like above, go to the address and enter the code. You then log in with your NAV e-mail and password. When done, <code>kubectl</code> will update your <code>kubeconfig</code>-file with the tokens needed to gain access to the cluster.</p>
<h2 id="recommended-tools">Recommended tools<a class="headerlink" href="#recommended-tools" title="Permanent link">§</a></h2>
<ul>
<li><a href="https://github.com/ahmetb/kubectx">kubectx</a> - Simplifies changing cluster and namespace context.</li>
<li><a href="https://github.com/jhrv/kubeaware">kubeaware</a> - Visualize which cluster and namespace is currently active.</li>
<li><a href="https://github.com/terjesannum/emacs-kubectx-mode">emacs-kubectx-mode</a> - Switch kubectl context and namespace in Emacs and display current setting in mode line.</li>
</ul></main>
            
            
        </div>
    </div>

    

        <footer class="py-3 mt-3 border-top">
    

        
        <p class="text-center">
            
        </p>
        <p class="text-center">
            <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> and modified <a href="https://sourcefoundry.org/cinder/">Cinder theme</a></small>
        </p>
        

        

    
</footer>


    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="../../js/bootstrap.bundle.min.js"></script>

    
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.0/build/highlight.min.js"></script>
        

    <script>hljs.highlightAll();</script>
    

    <script>var base_url = "../.."</script>

    

    <script src="../../js/base.js"></script>
    <script src="../../search/main.js"></script>

    <div class="modal fade" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title" id="searchModalLabel">Search documentation modal</span>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close search documentation modal"></button>
            </div>
            <div class="modal-header">
                <form autocomplete="off" class="flex-fill">
                    <div class="form-group">
                        <label class="form-label" id="search-input-label" for="mkdocs-search-query">Search for:</label>
                        <input type="search" class="form-control" placeholder="Type to start searching ..." id="mkdocs-search-query"
                            title="Type search term here" aria-labelledby="search-input-label">

                        <span class="form-text" role="status" id="mkdocs-search-results-info">
                            
                        </span>
                    </div>
                </form>
            </div>
            <div class="modal-body">
                <div aria-label="Search results" id="mkdocs-search-results">
                    
                </div>
            </div>
            <div class="modal-footer"></div>
        </div>
    </div>
</div>
    <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    </body>

</html>

